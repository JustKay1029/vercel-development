<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Slayy Queen üëë</title>
    
    <style>
        /* --- CSS STYLES --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            color: #4a4a4a;
            background: #000; /* Default background */
        }

        /* Animated Gradient Background for early phases */
        .background-animate {
            background: linear-gradient(-45deg, #000000, #880e4f, #0a0a0a, #e91e63);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            transition: opacity 2s ease; /* For smooth fade to black */
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .hidden { display: none !important; opacity: 0; }
        .fade-in { animation: fadeIn 1.5s ease-in-out forwards; }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* --- PHASE 1: PASSWORD SCREEN --- */
        #password-screen {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            height: 100%; text-align: center; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(5px);
        }
        h1 { font-size: 2.5rem; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); margin-bottom: 20px; }
        input {
            padding: 15px; font-size: 1.2rem; border-radius: 30px; border: 2px solid #fff;
            background: rgba(255,255,255,0.8); text-align: center; width: 80%; max-width: 300px;
            outline: none; color: #e91e63; font-weight: bold;
        }
        button {
            margin-top: 20px; padding: 12px 30px; font-size: 1rem; background: #ffffff;
            color: #e91e63; border: none; border-radius: 30px; cursor: pointer; transition: transform 0.2s;
        }
        button:active { transform: scale(0.95); }
        #hint-msg { margin-top: 15px; color: #fff; font-weight: bold; min-height: 20px; font-style: italic; }

        /* --- PHASE 2: MAIN PAGE & ENVELOPE --- */
        #main-page { height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .gold-text { color: #d4af37; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        .main-title { font-size: 2rem; margin-bottom: 10px; }
        .sub-names { font-size: 1.2rem; margin-bottom: 30px; font-weight: normal; letter-spacing: 1px; }
        .footer-sign { margin-top: 20px; font-size: 1rem; opacity: 0.8; }
        .envelope { font-size: 5rem; cursor: pointer; animation: float 3s ease-in-out infinite; transition: transform 0.3s; }
        .envelope:hover { transform: scale(1.1); }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-20px); } 100% { transform: translateY(0px); } }

        /* --- LETTER MODAL --- */
        #letter-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center; z-index: 10;
        }
        .card {
            background: #fffafa; width: 90%; max-width: 500px; padding: 30px;
            border-radius: 10px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); text-align: center; border: 2px solid #d4af37;
        }
        #typewriter-text { font-size: 1.1rem; line-height: 1.6; color: #555; min-height: 150px; margin-bottom: 20px; text-align: left; }

        /* --- PHASE 3: SLIDESHOW --- */
        #slideshow-container { height: 100%; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; z-index: 5; }
        .slide-img { max-width: 100%; max-height: 70vh; border-radius: 5px; box-shadow: 0 0 20px rgba(255,255,255,0.2); animation: softZoom 5s infinite alternate; }
        @keyframes softZoom { from { transform: scale(1); } to { transform: scale(1.05); } }
        .caption { color: white; margin-top: 15px; font-size: 1.2rem; font-style: italic; }
        .nav-btn { position: absolute; bottom: 30px; padding: 10px 20px; background: rgba(255,255,255,0.2); color: white; border: 1px solid white; border-radius: 5px; cursor: pointer; z-index: 10;}
        .nav-btn:hover { background: rgba(255,255,255,0.4); }

        /* --- FINAL PHASE: FIREWORKS PROPOSAL --- */
        #final-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; z-index: 20; background: transparent; pointer-events: none;
        }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 15; background: #000;}
        
        .proposal-text {
            font-size: 2.5rem; color: #ffebf0; font-weight: bold; margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(255, 77, 109, 0.8), 0 0 30px rgba(255, 77, 109, 0.5);
            animation: pulseText 2s infinite; z-index: 20; pointer-events: auto;
        }
        .sub-proposal { font-size: 1.5rem; color: #fff; text-shadow: 0 0 10px rgba(255,255,255,0.5); z-index: 20; }
        
        @keyframes pulseText { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }

        @media (max-width: 600px) { h1 { font-size: 1.8rem; } .proposal-text { font-size: 1.8rem; padding: 0 10px;} .card { width: 95%; } }
    </style>
</head>
<body>

    <div class="background-animate" id="bg-layer"></div>

    <audio id="bg-music" loop>
        <source src="piano.mp3" type="audio/mpeg">
    </audio>

    <div id="password-screen">
        <h1>What are you to me? ‚ù§Ô∏è</h1>
        <input type="text" id="pass-input" placeholder="Type here...">
        <div id="hint-msg"></div>
        <button onclick="checkPassword()">Unlock My Heart</button>
    </div>

    <div id="main-page" class="hidden">
        <h1 class="main-title gold-text">For My Slayy Queen üëë</h1>
        <h2 class="sub-names">Mrs Gupta ‚Ä¢ Hima ‚Ä¢ Isha ‚Ä¢ Gappa</h2>
        <div class="envelope" onclick="openLetter()">üíå</div>
        <p class="footer-sign">From Himanipaglu üíò</p>
    </div>

    <div id="letter-modal" class="hidden">
        <div class="card">
            <div id="typewriter-text"></div>
            <button id="continue-btn" class="hidden" onclick="startSlideshow()">Continue üíï</button>
        </div>
    </div>

    <div id="slideshow-container" class="hidden">
        <img id="slide-img" class="slide-img" src="" alt="Romantic Memory">
        <div id="slide-caption" class="caption">Photo 1 üíï</div>
        <button class="nav-btn" onclick="nextSlide()">Next Please ‚û°Ô∏è</button>
    </div>

    <canvas id="fireworks-canvas" class="hidden"></canvas>
    <div id="final-screen" class="hidden">
        <h1 class="proposal-text">I LOVE YOU MRS HIMANI GUPTA ‚ù§Ô∏è</h1>
        <p class="sub-proposal">Will you be my forever?</p>
    </div>

    <script>
        const correctPassword = "WIFE";
        const hints = [
            "I know babe you can do better",
            "Try thinking what you want to be",
            "Meri Pagli Laal lehenge mein kitni sundar lagegi",
            "Meri Isha, achche se socho"
        ];

        const letterLines = [
            "My Dearest Isha,",
            "Every moment with you feels like a dream.",
            "You are my happiness, my chaos, and my calm.",
            "I can't imagine a single day without you.",
            "Wait, a day? Main tere bina eK pal bhi imagine nahi Kar saKta.",
            "Tujhe Khone Ke Khayal se bhi darr lagta hai mujhe, But",
            "I Know that we both will always love each other.",
            "You are my Favourite person yaarrrr.",
            "Iss favourite person KI Kuch photos meri bohot fav hain...",
        ];

        let currentSlide = 1;
        const totalSlides = 17;
        let slideInterval;

        function checkPassword() {
            const input = document.getElementById("pass-input").value.trim().toUpperCase();
            if (input === correctPassword) {
                document.getElementById("password-screen").style.display = "none";
                document.getElementById("main-page").classList.remove("hidden");
                document.getElementById("main-page").classList.add("fade-in");
                const audio = document.getElementById("bg-music");
                audio.volume = 0.3;
                audio.play().catch(e => console.log("Audio play failed"));
            } else {
                const hintDiv = document.getElementById("hint-msg");
                hintDiv.innerText = hints[Math.floor(Math.random() * hints.length)];
                hintDiv.style.color = "#ffb3c6";
                const inputField = document.getElementById("pass-input");
                inputField.style.border = "2px solid red";
                setTimeout(() => inputField.style.border = "2px solid white", 500);
            }
        }

        function openLetter() {
            document.getElementById("letter-modal").classList.remove("hidden");
            document.getElementById("typewriter-text").innerHTML = "";
            let lineIndex = 0, charIndex = 0;

            function typeLine() {
                const textContainer = document.getElementById("typewriter-text");
                if (lineIndex < letterLines.length) {
                    if (charIndex < letterLines[lineIndex].length) {
                        textContainer.innerHTML += letterLines[lineIndex].charAt(charIndex);
                        charIndex++;
                        setTimeout(typeLine, 50);
                    } else {
                        textContainer.innerHTML += "<br><br>";
                        lineIndex++;
                        charIndex = 0;
                        setTimeout(typeLine, 800);
                    }
                } else {
                    document.getElementById("continue-btn").classList.remove("hidden");
                }
            }
            typeLine();
        }

        function startSlideshow() {
            document.getElementById("main-page").style.display = "none";
            document.getElementById("letter-modal").style.display = "none";
            document.getElementById("bg-layer").style.opacity = "0"; // Fade background to black
            document.getElementById("slideshow-container").classList.remove("hidden");
            document.getElementById("slideshow-container").classList.add("fade-in");
            
            showSlide(currentSlide);
            slideInterval = setInterval(() => { if(currentSlide <= totalSlides) nextSlide(); }, 5000);
        }

        function showSlide(n) {
            const img = document.getElementById("slide-img");
            img.onerror = function() { this.src = "https://via.placeholder.com/400x600/333/fff?text=Memory+" + n; };
            img.src = `photo${n}.jpeg`;
            document.getElementById("slide-caption").innerText = `Photo ${n} üíï`;
            img.style.animation = 'none';
            img.offsetHeight; 
            img.style.animation = 'softZoom 5s infinite alternate';
        }

        function nextSlide() {
            if (currentSlide < totalSlides) {
                currentSlide++;
                showSlide(currentSlide);
            } else {
                clearInterval(slideInterval);
                triggerFinale();
            }
        }

        // --- FIREWORKS LOGIC ---
        function triggerFinale() {
            document.getElementById("slideshow-container").style.display = "none";
            
            const canvas = document.getElementById("fireworks-canvas");
            const finalScreen = document.getElementById("final-screen");
            
            canvas.classList.remove("hidden");
            canvas.classList.add("fade-in");
            finalScreen.classList.remove("hidden");
            finalScreen.classList.add("fade-in");
            
            startFireworks();
        }

        function startFireworks() {
            const canvas = document.getElementById("fireworks-canvas");
            const ctx = canvas.getContext("2d");
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            window.addEventListener("resize", () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });

            const particles = [];
            const rockets = [];
            const colors = ["#ff4d6d", "#ff758f", "#ff99ac", "#ffb3c6", "#ffffff"];

            // Math to calculate heart shape coordinates
            function getHeartVector(t, scale) {
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                return { x: x * scale, y: y * scale };
            }

            class Particle {
                constructor(x, y, vx, vy, color) {
                    this.x = x; this.y = y;
                    this.vx = vx; this.vy = vy;
                    this.color = color;
                    this.alpha = 1;
                    this.decay = Math.random() * 0.015 + 0.005; // Fade out speed
                }
                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    this.alpha -= this.decay;
                }
                draw() {
                    ctx.save();
                    ctx.globalAlpha = this.alpha;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 8;
                    ctx.shadowColor = this.color;
                    ctx.fill();
                    ctx.restore();
                }
            }

            class Rocket {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = canvas.height;
                    this.targetY = Math.random() * (canvas.height * 0.5) + 50; // Explode in top half
                    this.speed = Math.random() * 3 + 4;
                    this.color = colors[Math.floor(Math.random() * colors.length)];
                    this.exploded = false;
                }
                update() {
                    this.y -= this.speed;
                    if (this.y <= this.targetY) {
                        this.exploded = true;
                        this.explode();
                    }
                }
                draw() {
                    if (!this.exploded) {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                        ctx.fillStyle = this.color;
                        ctx.fill();
                    }
                }
                explode() {
                    const scale = Math.random() * 0.2 + 0.15; // Size of the heart explosion
                    for (let t = 0; t < Math.PI * 2; t += 0.1) {
                        let vec = getHeartVector(t, scale);
                        // Add slight random scatter for glitter effect
                        vec.x += (Math.random() - 0.5) * 0.5;
                        vec.y += (Math.random() - 0.5) * 0.5;
                        particles.push(new Particle(this.x, this.y, vec.x, vec.y, this.color));
                    }
                }
            }

            function animate() {
                // Clear screen with a slight opacity to create light trails
                ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Randomly launch rockets
                if (Math.random() < 0.03) {
                    rockets.push(new Rocket());
                }

                for (let i = rockets.length - 1; i >= 0; i--) {
                    rockets[i].update();
                    rockets[i].draw();
                    if (rockets[i].exploded) rockets.splice(i, 1);
                }

                for (let i = particles.length - 1; i >= 0; i--) {
                    particles[i].update();
                    particles[i].draw();
                    if (particles[i].alpha <= 0) particles.splice(i, 1);
                }

                requestAnimationFrame(animate);
            }
            
            animate(); // Kick off the loop
        }
    </script>
</body>
</html>